Chapter 3 Exercises - Applied
================

-   [Question 8](#question-8)
    -   [Part 8a](#part-8a)
    -   [Part 8b](#part-8b)
    -   [Part 8c](#part-8c)

Question 8
----------

**This question involves the use of simple linear regression on the `Auto` data set.**

We start off by loading the data and taking a look at its structure:

``` r
data("Auto")
names(Auto)
```

    ## [1] "mpg"          "cylinders"    "displacement" "horsepower"  
    ## [5] "weight"       "acceleration" "year"         "origin"      
    ## [9] "name"

``` r
str(Auto)
```

    ## 'data.frame':    392 obs. of  9 variables:
    ##  $ mpg         : num  18 15 18 16 17 15 14 14 14 15 ...
    ##  $ cylinders   : num  8 8 8 8 8 8 8 8 8 8 ...
    ##  $ displacement: num  307 350 318 304 302 429 454 440 455 390 ...
    ##  $ horsepower  : num  130 165 150 150 140 198 220 215 225 190 ...
    ##  $ weight      : num  3504 3693 3436 3433 3449 ...
    ##  $ acceleration: num  12 11.5 11 12 10.5 10 9 8.5 10 8.5 ...
    ##  $ year        : num  70 70 70 70 70 70 70 70 70 70 ...
    ##  $ origin      : num  1 1 1 1 1 1 1 1 1 1 ...
    ##  $ name        : Factor w/ 304 levels "amc ambassador brougham",..: 49 36 231 14 161 141 54 223 241 2 ...

### Part 8a

**Use the lm() function to perform a simple linear regression with mpg as the response and horsepower as the predictor. Use the summary() function to print the results. Comment on the output.**

``` r
mpg_hp_lm <- lm(mpg ~ horsepower, data = Auto)
summary(mpg_hp_lm)
```

    ## 
    ## Call:
    ## lm(formula = mpg ~ horsepower, data = Auto)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -13.5710  -3.2592  -0.3435   2.7630  16.9240 
    ## 
    ## Coefficients:
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) 39.935861   0.717499   55.66   <2e-16 ***
    ## horsepower  -0.157845   0.006446  -24.49   <2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 4.906 on 390 degrees of freedom
    ## Multiple R-squared:  0.6059, Adjusted R-squared:  0.6049 
    ## F-statistic: 599.7 on 1 and 390 DF,  p-value: < 2.2e-16

**For example:**

1.  Is there a relationship between the predictor and the response?
2.  How strong is the relationship between the predictor and the response?
3.  Is the relationship between the predictor and the response positive or negative?
4.  What is the predicted mpg associated with a horsepower of 98? What are the associated 95% confidence and prediction intervals?

The relation between the predictor `horsepower` and response `mpg` is negative, as shown by the estimated coefficient **-0.1578447** which is less than 0.

Based on the output generated by the linear model, the p-value associated with the coefficient for `horsepower` is extremely low. We can conclude that there is a **significant negative** relationship between `horsepower` and `mpg`.

The strength of the relationship between `horsepower` and `mpg` is indicated by the *Pearson correlation coefficient*. For a simple linear regression model, the correlation coefficient can be found by taking the *negative* square root (since the linear coefficient is negative) of the Multiple R-squared value in the output:

``` r
-sqrt(summary(mpg_hp_lm)$r.squared)
```

    ## [1] -0.7784268

Alternatively, the correlation coefficient can be found using the `cor()` function:

``` r
cor(Auto$mpg, Auto$horsepower)
```

    ## [1] -0.7784268

The magnitude of the correlation coefficient suggests a **moderately strong relationship** between `horsepower` and `mpg`.

We can find out the predicted values of `mpg` and their intervals using the `predict()` function.
The following code attempts to predict `mpg` and the 95% confidence intervals for a given set of `horsepower` values:

``` r
predict(mpg_hp_lm, newdata = data.frame(horsepower = 98), 
        interval = "confidence")
```

    ##        fit      lwr      upr
    ## 1 24.46708 23.97308 24.96108

We change the `interval` parameter if we want to calculate the 95% *prediction* intervals:

``` r
predict(mpg_hp_lm, newdata = data.frame(horsepower = 98), 
        interval = "prediction")
```

    ##        fit     lwr      upr
    ## 1 24.46708 14.8094 34.12476

Based on the output, for `horsepower` of 98, the predicted `mpg` value would be about **24.47** (miles per gallon); the 95% confidence interval would be approximately **(23.97, 24.96)** and the 95% prediction interval would be approximately **(14.81, 34.12)**.
(The confidence interval reflects the uncertainty surrounding the predicted `mpg` averaged over multiple vehicles; the prediction interval reflects the uncertainty surrounding the `mpg` predicted for a particular vehicle, which also takes into the account the irreducible error ϵ.)

### Part 8b

**Plot the response and the predictor. Use the abline() function to display the least squares regression line.**

``` r
plot(mpg ~ horsepower, data = Auto, pch = 1, cex = 0.6,
     main = "Miles per gallon against Horsepower",
     xlab = "Engine Horsepower", ylab = "Miles per Gallon")
abline(mpg_hp_lm)
```

![](readme_files/figure-markdown_github/q8%20plot-1.png)

### Part 8c

**Use the plot() function to produce diagnostic plots of the least squares regression fit. Comment on any problems you see with the fit.**

``` r
par(mfrow = c(2,2))
plot(mpg_hp_lm)
```

![](readme_files/figure-markdown_github/q8%20diagnostic%20plot-1.png)

A brief description of the diagnostic plots shown above:

-   The top-left plot is a residual plot, which plots the residuals *e<sub>i</sub> = y<sub>i</sub> - ŷ<sub>i</sub>* against the fitted values.
-   The top-right plot is a quantile-quantile plot (QQ plot) of the residuals to check if the residuals are normally distributed.
-   The bottom-left plot is a scale-location plot that examines if residuals are spread equally along the range of predictors and can be used to check the assumption of equal variance (homoscedascity).
-   The bottom-right plot is a plot of residuals against leverage, to check for outliers with significant leverage that would heavily influence the regression model.

From the diagnostic plots, we can see the following issues:

-   The plot of residuals against fitted values appear to exhibit a pattern which suggests that our linear model is not a good fit for the relationship between `horsepower` and `mpg`: the pattern in the residuals may be due to a non-linear relationship that the model does not capture.
